<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 380">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#0078d4"/>
      <stop offset="100%" style="stop-color:#50e6ff"/>
    </linearGradient>
    <linearGradient id="boxGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ffffff"/>
      <stop offset="100%" style="stop-color:#f0f0f0"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="1" dy="1" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="600" height="380" fill="#fafafa"/>

  <!-- Header -->
  <rect x="15" y="10" width="570" height="30" rx="4" fill="url(#headerGrad)"/>
  <text x="300" y="31" text-anchor="middle" fill="white" font-family="Segoe UI, Arial, sans-serif" font-size="14" font-weight="600">CLOUDSHOP ORDER PIPELINE</text>

  <!-- Row 1: Partners -> APIM -> Orders API -->
  <rect x="25" y="55" width="80" height="45" rx="5" fill="url(#boxGrad)" stroke="#0078d4" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="65" y="82" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333">Partners</text>

  <line x1="110" y1="77" x2="140" y2="77" stroke="#0078d4" stroke-width="2"/>
  <polygon points="140,73 150,77 140,81" fill="#0078d4"/>

  <rect x="155" y="50" width="100" height="55" rx="5" fill="#0078d4" filter="url(#shadow)"/>
  <text x="205" y="73" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="white" font-weight="600">APIM Gateway</text>
  <text x="205" y="90" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#b3d9ff">(Mod 08)</text>

  <line x1="260" y1="77" x2="290" y2="77" stroke="#0078d4" stroke-width="2"/>
  <polygon points="290,73 300,77 290,81" fill="#0078d4"/>

  <rect x="305" y="55" width="95" height="45" rx="5" fill="url(#boxGrad)" stroke="#0078d4" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="352" y="75" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333">Orders API</text>
  <text x="352" y="90" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#666">(Function)</text>

  <!-- Arrow down from Orders API to Blob -->
  <line x1="352" y1="105" x2="352" y2="115" stroke="#50e6ff" stroke-width="2"/>
  <line x1="352" y1="115" x2="260" y2="115" stroke="#50e6ff" stroke-width="2"/>
  <line x1="260" y1="115" x2="260" y2="125" stroke="#50e6ff" stroke-width="2"/>
  <polygon points="256,125 260,135 264,125" fill="#50e6ff"/>

  <!-- Row 2: Batch -> Blob Storage -> Event Grid -->
  <rect x="25" y="140" width="80" height="45" rx="5" fill="url(#boxGrad)" stroke="#50e6ff" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="65" y="160" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333">Batch</text>
  <text x="65" y="175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333">Upload</text>

  <line x1="110" y1="162" x2="150" y2="162" stroke="#50e6ff" stroke-width="2"/>
  <polygon points="150,158 160,162 150,166" fill="#50e6ff"/>

  <rect x="165" y="135" width="100" height="55" rx="5" fill="#50e6ff" filter="url(#shadow)"/>
  <text x="215" y="158" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333" font-weight="600">Blob Storage</text>
  <text x="215" y="175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#333">orders/</text>

  <line x1="270" y1="162" x2="300" y2="162" stroke="#773adc" stroke-width="2"/>
  <polygon points="300,158 310,162 300,166" fill="#773adc"/>

  <rect x="315" y="135" width="95" height="55" rx="5" fill="#773adc" filter="url(#shadow)"/>
  <text x="362" y="158" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="white" font-weight="600">Event Grid</text>
  <text x="362" y="175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#d4c4f0">(Mod 09)</text>

  <!-- Arrow from Event Grid to Service Bus -->
  <line x1="415" y1="162" x2="445" y2="162" stroke="#e81123" stroke-width="2"/>
  <polygon points="445,158 455,162 445,166" fill="#e81123"/>

  <rect x="460" y="135" width="95" height="55" rx="5" fill="#e81123" filter="url(#shadow)"/>
  <text x="507" y="158" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="white" font-weight="600">Service Bus</text>
  <text x="507" y="175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#ffc4c4">(Mod 10)</text>

  <!-- Arrow down from Service Bus to Workers -->
  <line x1="507" y1="195" x2="507" y2="215" stroke="#e81123" stroke-width="2"/>
  <polygon points="503,215 507,225 511,215" fill="#e81123"/>

  <rect x="460" y="230" width="95" height="40" rx="5" fill="url(#boxGrad)" stroke="#e81123" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="507" y="255" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333">Workers</text>

  <!-- Row 3: Website -> Event Hubs -> Capture -->
  <rect x="25" y="225" width="80" height="45" rx="5" fill="url(#boxGrad)" stroke="#ff8c00" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="65" y="245" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333">Website</text>
  <text x="65" y="260" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#666">(clicks)</text>

  <line x1="110" y1="247" x2="150" y2="247" stroke="#ff8c00" stroke-width="2"/>
  <polygon points="150,243 160,247 150,251" fill="#ff8c00"/>

  <rect x="165" y="220" width="100" height="55" rx="5" fill="#ff8c00" filter="url(#shadow)"/>
  <text x="215" y="243" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="white" font-weight="600">Event Hubs</text>
  <text x="215" y="260" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="9" fill="#ffe4c4">(Mod 09)</text>

  <line x1="270" y1="247" x2="300" y2="247" stroke="#ff8c00" stroke-width="2"/>
  <polygon points="300,243 310,247 300,251" fill="#ff8c00"/>

  <rect x="315" y="225" width="95" height="45" rx="5" fill="url(#boxGrad)" stroke="#ff8c00" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="362" y="252" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="11" fill="#333">Capture</text>

  <!-- Application Insights bar at bottom -->
  <rect x="15" y="295" width="570" height="70" rx="5" fill="#107c10" filter="url(#shadow)"/>
  <text x="300" y="325" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="13" fill="white" font-weight="600">Application Insights (Mod 11)</text>
  <text x="300" y="345" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" font-size="10" fill="#c4e8c4">monitors entire pipeline</text>

  <!-- Dotted lines to App Insights -->
  <line x1="205" y1="110" x2="205" y2="290" stroke="#107c10" stroke-width="1" stroke-dasharray="3,3" opacity="0.4"/>
  <line x1="362" y1="195" x2="362" y2="290" stroke="#107c10" stroke-width="1" stroke-dasharray="3,3" opacity="0.4"/>
  <line x1="507" y1="275" x2="507" y2="290" stroke="#107c10" stroke-width="1" stroke-dasharray="3,3" opacity="0.4"/>
</svg>
